window.__require=function t(e,o,n){function i(a,s){if(!o[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var u="function"==typeof __require&&__require;if(!s&&u)return u(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var p=o[a]={exports:{}};e[a][0].call(p.exports,function(t){return i(e[a][1][t]||t)},p,p.exports,t,e,o,n)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({drawGunFight:[function(t,e,o){"use strict";cc._RF.push(e,"8e890L0aaBJL6Bei503XMuq","drawGunFight");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function a(t){try{c(n.next(t))}catch(e){r(e)}}function s(t){try{c(n.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../module/component/scripts/GameCompBase"),u=t("../../../module/kit/audio/AudioManager"),p=t("../../../module/kit/TigoManager"),h=cc._decorator,l=h.ccclass,d=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tigoAni=null,e.hopperAni=null,e.vsAni=null,e.boardNode=null,e.drawGunItem=null,e.proBar=null,e.block=null,e.handNode=null,e.wordLab=null,e.vocieNode=null,e.hopperHeartNode=null,e.caoNode=null,e.showNode=[],e.cur_index=0,e.sounds_arr=["He_is_a_chef","He_is_a_police_officer","He_is_a_waiter","He_is_a_chef"],e.words_arr=["He is a chef.","He is a police officer.","He is a waiter.","He is a chef."],e.handcallback=null,e.wrongNum=0,e.answer_arr=[0,1,2,1],e.barTween=null,e.maxTime=2,e}return i(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.tigoAni.setCompleteListener(this.tigoAniback.bind(this)),this.hopperAni.setCompleteListener(this.hopperAniback.bind(this))},e.prototype.getMoveTime=function(){var t=1/this.maxTime;return(1-this.proBar.progress)/t},e.prototype.onGameStart=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return u.default.playMusic(this.bundleName,"res/audios/bgm"),this.showTipAni(),this.scheduleOnce(function(){t.guideRound();var e=t.caoNode.getChildByName("cao");cc.tween(e).by(2.5,{angle:360}).repeatForever().start(),t.cueGrassFun()},8),[2]})})},e.prototype.showTipAni=function(){var t=this;this.node.getChildByName("show").active=!0;var e=0;this.schedule(function(){t.showWord(e+1,!1),cc.tween(t.showNode[e]).by(.5,{scale:.2}).by(.5,{scale:-.2}).delay(.25).call(function(){3==++e&&t.scheduleOnce(function(){t.wordLab.string="",t.node.getChildByName("show").destroy()},1.5)}).start()},2.2,2)},e.prototype.guideRound=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(e){switch(e.label){case 0:return this.maxTime=1,[4,this.bartipAni()];case 1:return e.sent(),[4,this.startCountTime()];case 2:return e.sent(),this.hopperShoot(),this.scheduleOnce(function(){t.beginFun()},2),[2]}})})},e.prototype.guideYou=function(){var t=this.tigoAni.node.getChildByName("1");t.active=!0,cc.tween(t).by(.3,{y:-15}).by(.3,{y:15}).union().repeat(3).to(.3,{opacity:0}).call(function(){t.active=!1}).start()},e.prototype.beginFun=function(){var t=this;u.default.playEffect(this.bundleName,"res/audios/listen_and_click",function(){t.node.getChildByName("donhua").getChildByName("vs").active=!0,u.default.playEffect(t.bundleName,"res/audios/vs"),t.hopperHeartNode.active=!0,t.scheduleOnce(function(){return t.startRound()},2)})},e.prototype.bartipAni=function(){var t=this;return new Promise(function(e){cc.tween(t.proBar.node).by(.2,{scale:.1}).by(.2,{scale:-.1}).union().repeat(4).call(function(){e()}).start()})},e.prototype.itemtipAni=function(){var t=this;return new Promise(function(e){cc.tween(t.boardNode).to(.2,{scale:1.2}).to(.2,{scale:1}).union().repeat(2).call(function(){e()}).start()})},e.prototype.cueGrassFun=function(){this.caoNode.x=1e3,cc.tween(this.caoNode).to(6,{x:-1e3}).start()},e.prototype.removeOneHeart=function(){var t=this.hopperHeartNode.childrenCount-(this.cur_index+1);if(t>=0){var e=this.hopperHeartNode.children[t].getChildByName("heart1");this.heartGoneAni(e)}},e.prototype.heartGoneAni=function(t){return new Promise(function(e){cc.tween(t).parallel(cc.tween().to(.5,{opacity:0}),cc.tween().to(.5,{scale:.2})).call(function(){t.destroy(),e()}).start()})},e.prototype.startRound=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(e){switch(e.label){case 0:return this.maxTime=4,[4,this.assembleItem(3)];case 1:return e.sent(),[4,this.showWord(this.cur_index)];case 2:return e.sent(),0==this.cur_index?(this.guideYou(),this.scheduleOnce(function(){t.pauseHopperCount(),t.handNode.active=!0,t.setBlock(!1)},2)):this.setBlock(!1),[4,this.startCountTime()];case 3:return e.sent(),this.whenCountEnd(),[2]}})})},e.prototype.whenCountEnd=function(){var t=this;this.setBlock(!0),this.boardNode.opacity=0,this.hopperShoot(),this.scheduleOnce(function(){return t.startRound()},1.5)},e.prototype.showWord=function(t,e){var o=this;return void 0===e&&(e=!0),new Promise(function(n){o.wordLab.string=o.words_arr[t],u.default.playAudioSound(o.bundleName,"res/audios/"+o.sounds_arr[t],function(){e?o.scheduleOnce(function(){o.wordLab.string="",n()},.1):n()})})},e.prototype.hopperShoot=function(){var t=this;this.stopHopperCount(),this.playhopperAin(1),this.scheduleOnce(function(){t.playtigoAin(2)},.5)},e.prototype.tigoShoot=function(){var t=this;this.stopHopperCount(),this.playtigoAin(1),this.scheduleOnce(function(){t.playhopperAin(2)},.5)},e.prototype.stopHopperCount=function(){u.default.stopEffect(),this.barTween.stop(),this.proBar.progress=0},e.prototype.pauseHopperCount=function(){u.default.stopEffect(),this.barTween.stop()},e.prototype.resumeHopperCount=function(){var t=this,e=this.getMoveTime();cc.tween(this.proBar).to(e,{progress:1}).call(function(){t.whenCountEnd()}).start()},e.prototype.startCountTime=function(){var t=this;return u.default.playEffect(this.bundleName,"res/audios/xuli"),this.proBar.progress=0,new Promise(function(e){t.barTween=cc.tween(t.proBar).to(t.maxTime,{progress:1}).tag(1).call(function(){cc.log("count tween end"),e()}).start()})},e.prototype.onItemClicked=function(t,e){return a(this,void 0,void 0,function(){var t=this;return s(this,function(o){switch(o.label){case 0:return e?(0==this.cur_index&&this.handNode.active&&(this.handNode.active=!1),this.setBlock(!0),this.showCoin(),this.stopHopperCount(),[4,this.showWord(this.cur_index)]):[3,2];case 1:return o.sent(),this.tigoShoot(),this.scheduleOnce(function(){t.removeOneHeart(),t.boardNode.opacity=0},.4),this.scheduleOnce(function(){return t.nextRound()},2),[3,3];case 2:0!=this.cur_index&&(this.setBlock(!0),this.pauseHopperCount(),this.whenCountEnd()),this.wrongNum++,o.label=3;case 3:return[2]}})})},e.prototype.nextRound=function(){if(this.cur_index++,this.cur_index>=this.answer_arr.length)return cc.log("all round end"),void this.endAni();this.startRound()},e.prototype.endAni=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(e){switch(e.label){case 0:return this.playtigoAin(4,!0),[4,this.playhopperAin(3)];case 1:return e.sent(),this.playhopperAin(4,!0),this.scheduleOnce(function(){return t.onGameEnd()},1.5),[2]}})})},e.prototype.assembleItem=function(t){var e=this;this.boardNode.removeAllChildren();for(var o=0;o<t;o++){var n=cc.instantiate(this.drawGunItem),i=n.getComponent("drawGunItem"),r=o==this.answer_arr[this.cur_index];i.initItem(o,r,this.cur_index,this),this.boardNode.addChild(n)}return new Promise(function(t){cc.tween(e.boardNode).to(1,{opacity:255}).call(function(){t()}).start()})},e.prototype.playVoiceAni=function(){var t=this;this.vocieNode&&(this.vocieNode.getComponent("VoiceTools").playVoiceAni(),u.default.playAudioSound(this.bundleName,"res/audios/"+this.sounds_arr[this.cur_index]),this.scheduleOnce(function(){t.vocieNode.getComponent("VoiceTools").stopVoiceAni()},1))},e.prototype.playtigoAin=function(t,e){return void 0===e&&(e=!1),a(this,void 0,void 0,function(){var o;return s(this,function(n){switch(n.label){case 0:switch(o="",t){case 0:o="tigo_xie_zhunbeidongzuo";break;case 1:u.default.playEffect(this.bundleName,"res/audios/feichu"),o="tigo_xie_baqiangkaiqiang";break;case 2:u.default.playEffect(this.bundleName,"res/audios/jizhong"),o="tigo_xie_beijizhong";break;case 3:o="tigo_xie_shenglidongzuo";break;case 4:o="tigo_xie_shenglidongzuo_idle"}return[4,this.playSpine(this.tigoAni,o,e)];case 1:return n.sent(),[2]}})})},e.prototype.tigoAniback=function(t){var e=t;"tigo_xie_baqiangkaiqiang"!==e.animation.name&&"tigo_xie_beijizhong"!==e.animation.name||this.playtigoAin(0,!0)},e.prototype.playhopperAin=function(t,e){return void 0===e&&(e=!1),a(this,void 0,void 0,function(){var o;return s(this,function(n){switch(n.label){case 0:switch(o="",t){case 0:o="zhunbeidongzuo";break;case 1:o="baqiangkaiqiang";break;case 2:u.default.playEffect(this.bundleName,"res/audios/jizhong"),o="beijizhong";break;case 3:o="daodi";break;case 4:o="paidi"}return[4,this.playSpine(this.hopperAni,o,e)];case 1:return n.sent(),[2]}})})},e.prototype.hopperAniback=function(t){var e=t;"baqiangkaiqiang"!==e.animation.name&&"beijizhong"!==e.animation.name||this.playhopperAin(0,!0)},e.prototype.setBlock=function(t){t?this.block.y=0:(this.block.y=1500,this.itemtipAni()),this.vocieNode.active=!t},e.prototype.showCoin=function(){var t=3-this.wrongNum;t<3&&(t=2),p.default.callAppToTigoStar(t),this.wrongNum=0},e.prototype.playSpine=function(t,e,o){t.clearTracks(),t.setToSetupPose();var n=t.setAnimation(0,e,o);if(!o)return new Promise(function(e){t.setTrackCompleteListener(n,function(){e()})})},e.prototype.onGameEnd=function(){u.default.stopMusic(),this.gameEnd(0)},r([d(sp.Skeleton)],e.prototype,"tigoAni",void 0),r([d(sp.Skeleton)],e.prototype,"hopperAni",void 0),r([d(sp.Skeleton)],e.prototype,"vsAni",void 0),r([d(cc.Node)],e.prototype,"boardNode",void 0),r([d(cc.Prefab)],e.prototype,"drawGunItem",void 0),r([d(cc.ProgressBar)],e.prototype,"proBar",void 0),r([d(cc.Node)],e.prototype,"block",void 0),r([d(cc.Node)],e.prototype,"handNode",void 0),r([d(cc.Label)],e.prototype,"wordLab",void 0),r([d(cc.Node)],e.prototype,"vocieNode",void 0),r([d(cc.Node)],e.prototype,"hopperHeartNode",void 0),r([d(cc.Node)],e.prototype,"caoNode",void 0),r([d(cc.Node)],e.prototype,"showNode",void 0),r([l],e)}(c.default);o.default=f,cc._RF.pop()},{"../../../module/component/scripts/GameCompBase":void 0,"../../../module/kit/TigoManager":void 0,"../../../module/kit/audio/AudioManager":void 0}],drawGunItem:[function(t,e,o){"use strict";cc._RF.push(e,"1d06b1K9oVIxJvNHQF4MpsT","drawGunItem");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function a(t){try{c(n.next(t))}catch(e){r(e)}}function s(t){try{c(n.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../module/kit/assets/AssetsManger"),u=t("../../../module/kit/audio/AudioManager"),p=t("../../../scripts/GameData"),h=cc._decorator,l=h.ccclass,d=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemSp=null,e.button=null,e.mainCom=null,e.ansTag=!1,e.mid=0,e.mround=0,e.nameArr=[["chef","jingcha","waiter"],["waiter","jingcha","chef"],["chef","jingcha","waiter"],["jingcha","chef","waiter"]],e}return i(e,t),e.prototype.initItem=function(t,e,o,n){this.mid=t,this.ansTag=e,this.mround=o,this.mainCom=n},e.prototype.start=function(){this.setSpFun()},e.prototype.setSpFun=function(){return a(this,void 0,void 0,function(){var t,e,o;return s(this,function(n){switch(n.label){case 0:return t=this.nameArr[this.mround][this.mid],e="res/images/item/"+t,o=this.itemSp,[4,c.default.instance.loadImg(e,p.default.curBundleName)];case 1:return o.spriteFrame=n.sent(),[2]}})})},e.prototype.onClicked=function(){if(this.mainCom.onItemClicked(this.mid,this.ansTag),this.ansTag)this.button.interactable=!1,u.default.playEffect("commonRes","audio/game_right"),this.node.getChildByName("xingxing").active=!0;else{u.default.playEffect("commonRes","audio/game_error"),this.node.getChildByName("yanwu").active=!0;var t=this.node.getChildByName("yanwu").getComponent(sp.Skeleton);this.playSpine(t,"08_4_z_zhenzha",!1)}},e.prototype.playSpine=function(t,e,o){t.clearTracks(),t.setToSetupPose();var n=t.setAnimation(0,e,o);if(!o)return new Promise(function(e){t.setTrackCompleteListener(n,function(){e()})})},r([d(cc.Sprite)],e.prototype,"itemSp",void 0),r([d(cc.Button)],e.prototype,"button",void 0),r([l],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../module/kit/assets/AssetsManger":void 0,"../../../module/kit/audio/AudioManager":void 0,"../../../scripts/GameData":void 0}]},{},["drawGunFight","drawGunItem"]);