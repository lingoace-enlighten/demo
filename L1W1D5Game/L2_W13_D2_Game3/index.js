window.__require=function t(e,o,n){function i(s,a){if(!o[s]){if(!e[s]){var c=s.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!a&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var p=o[s]={exports:{}};e[s][0].call(p.exports,function(t){return i(e[s][1][t]||t)},p,p.exports,t,e,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({L2_W13_D2_G3_Board:[function(t,e,o){"use strict";cc._RF.push(e,"87683EEgUFE8LXws07FR4FJ","L2_W13_D2_G3_Board");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.knowledge=null,e.image=null,e}return i(e,t),e.prototype.show=function(t,e,o){this.node.active=!0,this.node.x=cc.winSize.width/2+this.node.width/2,this.knowledge.string=t,this.image.spriteFrame=e,cc.tween(this.node).to(2,{x:225}).call(function(){o&&o.apply(null)}).start()},e.prototype.hide=function(){this.node.active=!1},r([c(cc.Label)],e.prototype,"knowledge",void 0),r([c(cc.Sprite)],e.prototype,"image",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],L2_W13_D2_G3_Collection:[function(t,e,o){"use strict";cc._RF.push(e,"b069e/ByS1I0YEJvlYavYkd","L2_W13_D2_G3_Collection");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./L2_W13_D2_G3_Config"),a=cc._decorator,c=a.ccclass,l=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=0,e}return i(e,t),e.prototype.onLoad=function(){this.mCollected=!1,this.mSprite=this.getComponentInChildren(cc.Sprite),this.mCollider=this.node.getChildByName("collider")},e.prototype.startClip=function(){var t;if(0==this.type)t=cc.tween(this.node).to(1.2,{scale:1.1}).to(1.2,{scale:.9});else{var e=this.node.y;t=cc.tween(this.node).to(1.2,{y:e+10}).to(1.2,{y:e-10})}cc.tween(this.node).repeatForever(t).start()},e.prototype.onDestroy=function(){cc.Tween.stopAllByTarget(this.node)},e.prototype.setCollectionImage=function(t){this.mSprite&&(this.mSprite.spriteFrame=t,this.mSprite.node.scale=.35,this.startClip())},e.prototype.checkCollection=function(t){if(!this.mCollected&&!s.GameConfig.GamePaused){var e=this.mCollider.getBoundingBoxToWorld();if(t.intersects(e)){if(1==this.type){var o=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);s.EventCenter.dispatchEvent(new s.default("onCollectKnowledge",o))}else s.EventCenter.dispatchEvent(new s.default("onCollectPower"));this.collecting()}}},e.prototype.resetNode=function(){cc.Tween.stopAllByTarget(this.node),this.mSprite.node.scale=.35,this.node.opacity=255,this.node.scale=1,this.mCollected=!1},e.prototype.collecting=function(){this.mCollected=!0,cc.tween(this.node).to(.35,{opacity:0,scale:0},cc.easeCubicActionOut()).start()},Object.defineProperty(e.prototype,"collected",{get:function(){return this.mCollected},enumerable:!1,configurable:!0}),r([l({tooltip:"\u6536\u96c6\u7269\u7c7b\u578b,0\u80fd\u91cf\u5757,1\u77e5\u8bc6\u70b9"})],e.prototype,"type",void 0),r([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./L2_W13_D2_G3_Config":"L2_W13_D2_G3_Config"}],L2_W13_D2_G3_Config:[function(t,e,o){"use strict";cc._RF.push(e,"b9072SDayhIzIY6mn5K01DS","L2_W13_D2_G3_Config");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.GameConfig=o.Audios=o.Animations=o.RoleStatus=o.EventCenter=void 0,o.EventCenter=new cc.EventTarget;var r=function(t){function e(e,o){var n=t.call(this,e,!0)||this;return n.mData=o,n}return i(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.mData},enumerable:!1,configurable:!0}),e}(cc.Event);o.default=r,function(t){t[t.Idle=0]="Idle",t[t.Jump=1]="Jump",t[t.Run=2]="Run",t[t.Fall=3]="Fall",t[t.Platform=4]="Platform",t[t.PlatformJump=5]="PlatformJump",t[t.PlatformRun=6]="PlatformRun",t[t.CatchRun=7]="CatchRun",t[t.Fever=8]="Fever"}(o.RoleStatus||(o.RoleStatus={})),o.Animations={Idle:"zhanli_1",IdleWatch:"zhanli_2",Run:"huahuaban",FeverRun:"feverhuahuaban",PlatformRun:"hualangan",CatchRun:"zhuazhuagan",Fall:"luoxia",Jump:"qitiao",JumpLoop:"tiao"},o.Audios={Bgm:"BGM_huabanpaoku_03",Jump:"SE_huabanpaoku_01",Power:"SE_huabanpaoku_02",Fever:"SE_huabanpaoku_03",police:"police",waiter:"waiter",chef:"chef",ClickAndListen:"click_and_listen"},o.GameConfig={MapWidth:1784,MapHeight:1002,DistantSpeed:2,FrontSpeed:6,MapMinX:-1559,MapMaxX:2009,RoleJumpSpeedY:18,Gravity:.8,GamePaused:!0,FeverDurationTime:1e4,Configs:[{knowledge:"police officer",audio:o.Audios.police,totalCollectCount:5,totalPowerCount:20},{knowledge:"waiter",audio:o.Audios.waiter,totalCollectCount:5,totalPowerCount:20},{knowledge:"chef",audio:o.Audios.chef,totalCollectCount:5,totalPowerCount:20}]},cc._RF.pop()},{}],L2_W13_D2_G3_ItemLayer:[function(t,e,o){"use strict";cc._RF.push(e,"fb19a1NeJ1KVrjz4v3BwBf1","L2_W13_D2_G3_ItemLayer");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./L2_W13_D2_G3_Collection"),a=cc._decorator,c=a.ccclass,l=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){var t=this;this.mCollections=[],this.node.children.map(function(e){"collection"==e.name&&t.mCollections.push(e)})},e.prototype.resetLayer=function(){for(var t=0;t<this.mCollections.length;t++){var e=this.mCollections[t];e&&e.getComponent(s.default).resetNode()}},Object.defineProperty(e.prototype,"collections",{get:function(){return this.mCollections||[]},enumerable:!1,configurable:!0}),r([c],e)}(cc.Component));o.default=l,cc._RF.pop()},{"./L2_W13_D2_G3_Collection":"L2_W13_D2_G3_Collection"}],L2_W13_D2_G3_Light:[function(t,e,o){"use strict";cc._RF.push(e,"98adcjbF9BFaZzNuEZ4rr4Q","L2_W13_D2_G3_Light");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,c=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){var t=cc.tween(this.node).to(1,{opacity:0},cc.easeCubicActionOut()).delay(.2).to(1,{opacity:255},cc.easeCubicActionOut());cc.tween(this.node).repeatForever(t).start()},e.prototype.onDestroy=function(){cc.Tween.stopAllByTarget(this.node),this.node.opacity=255},r([a],e)}(cc.Component));o.default=c,cc._RF.pop()},{}],L2_W13_D2_G3_Map:[function(t,e,o){"use strict";cc._RF.push(e,"b2812dndWxByaXmibSDv/YO","L2_W13_D2_G3_Map");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./L2_W13_D2_G3_Config"),a=cc._decorator,c=a.ccclass,l=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skip=!1,e.skipNum=1,e.speed=5,e}return i(e,t),e.prototype.onLoad=function(){this.skipNum&&this.skip&&(this.mSkip=0)},e.prototype.update=function(){s.GameConfig.GamePaused||(this.skip?(this.mSkip++,this.mSkip>=this.skipNum&&(this.mSkip=0,this.node.x-=this.speed,this.node.x<=s.GameConfig.MapMinX&&(this.node.x=s.GameConfig.MapMaxX-(s.GameConfig.MapMinX-this.node.x)))):(this.node.x-=this.speed,this.node.x<=s.GameConfig.MapMinX&&(this.node.x=s.GameConfig.MapMaxX-(s.GameConfig.MapMinX-this.node.x))))},r([l({tooltip:"\u662f\u5426\u8df3\u5e27"})],e.prototype,"skip",void 0),r([l({tooltip:"\u8df3\u5e27\u6570, skip\u4e3atrue\u65f6\u6709\u7528"})],e.prototype,"skipNum",void 0),r([l({tooltip:"\u79fb\u52a8\u901f\u5ea6"})],e.prototype,"speed",void 0),r([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./L2_W13_D2_G3_Config":"L2_W13_D2_G3_Config"}],L2_W13_D2_G3_MaskProgress:[function(t,e,o){"use strict";cc._RF.push(e,"6067cfQN0dEWq4nB9JM4znk","L2_W13_D2_G3_MaskProgress");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isHorizontal=!0,e.changeAnimation=!0,e}return i(e,t),e.prototype.onLoad=function(){this.mCurValue=0,this.mMask=this.getComponentInChildren(cc.Mask),this.isHorizontal?(this.mMask.node.width=0,this.mFullValue=this.mMask.node.parent.width):(this.mMask.node.height=0,this.mFullValue=this.mMask.node.parent.height)},Object.defineProperty(e.prototype,"progress",{set:function(t){t<this.mCurValue&&1!=this.mCurValue&&cc.log("tag:"+this.name+", value:"+t),this.mCurValue=t,this.isHorizontal?this.mMask.node.width=this.mFullValue*this.mCurValue:this.mMask.node.height=this.mFullValue*this.mCurValue,this.changeAnimation&&(cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).set({scale:1}).to(.3,{scale:1.2},cc.easeCubicActionOut()).delay(.6).to(.3,{scale:1},cc.easeCircleActionOut()).start())},enumerable:!1,configurable:!0}),r([c({tooltip:"\u662f\u5426\u662f\u6a2a\u5411\u8fdb\u5ea6"})],e.prototype,"isHorizontal",void 0),r([c({tooltip:"\u8fdb\u5ea6\u53d8\u5316\u65f6\uff0c\u662f\u5426\u663e\u793a\u52a8\u753b"})],e.prototype,"changeAnimation",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],L2_W13_D2_G3_Platform:[function(t,e,o){"use strict";cc._RF.push(e,"35836pVSG5IuLobHu7UbT7l","L2_W13_D2_G3_Platform");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./L2_W13_D2_G3_Config"),a=cc._decorator,c=a.ccclass,l=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skip=!1,e.skipNum=1,e.speed=5,e.eventTag="showOtherPlatform",e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.mDispatched=!1,this.skipNum&&this.skip&&(this.mSkip=0),this.tickX=cc.winSize.width/2-this.node.width,this.hideX=-this.node.width-cc.winSize.width/2,this.mCollections=[],this.node.children.map(function(e){"collection"==e.name&&t.mCollections.push(e)})},e.prototype.update=function(){!s.GameConfig.GamePaused&&this.node.active&&(this.skip?(this.mSkip++,this.mSkip>=this.skipNum&&(this.mSkip=0,this.node.x-=this.speed,this.node.x<=this.hideX&&(this.node.x=5269-(this.hideX-this.node.x),s.EventCenter.dispatchEvent(new s.default(this.eventTag,this.node.x))))):(this.node.x-=this.speed,this.node.x<=this.hideX&&(this.node.x=5269-(this.hideX-this.node.x),s.EventCenter.dispatchEvent(new s.default(this.eventTag,this.node)))))},Object.defineProperty(e.prototype,"collections",{get:function(){return this.mCollections||[]},enumerable:!1,configurable:!0}),r([l({tooltip:"\u662f\u5426\u8df3\u5e27"})],e.prototype,"skip",void 0),r([l({tooltip:"\u8df3\u5e27\u6570, skip\u4e3atrue\u65f6\u6709\u7528"})],e.prototype,"skipNum",void 0),r([l({tooltip:"\u79fb\u52a8\u901f\u5ea6"})],e.prototype,"speed",void 0),r([l({tooltip:"\u4e8b\u4ef6\u6807\u8bc6"})],e.prototype,"eventTag",void 0),r([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./L2_W13_D2_G3_Config":"L2_W13_D2_G3_Config"}],L2_W13_D2_G3_Role:[function(t,e,o){"use strict";cc._RF.push(e,"7527eH0o2xLy4gd6JLJQzGW","L2_W13_D2_G3_Role");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./L2_W13_D2_G3_Config"),a=cc._decorator,c=a.ccclass,l=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIsFever=!1,e}return i(e,t),e.prototype.onLoad=function(){this.mJumpRate=1,this.mGravity=s.GameConfig.Gravity,this.mSpine=this.getComponent(sp.Skeleton),this.mFeverSpine=this.getComponentInChildren(sp.Skeleton),this.mFeverSpine.node.active=!1,this.mJumping=!1,this.mFalling=!1,this.mJumpSpeed=cc.Vec2.ZERO,this.mBaseY=this.node.y,this.playIdle()},e.prototype.update=function(){s.GameConfig.GamePaused||(this.mJumping||this.mFalling?(this.node.y+=this.mJumpSpeed.x,this.node.y+=this.mJumpSpeed.y,this.mJumpSpeed.y-=this.mGravity,this.node.y<=this.mBaseY&&(this.node.y=this.mBaseY,this.mJumping=!1,this.mFalling=!1,this.onLanding())):this.node.y>this.mBaseY&&0==this.mJumpSpeed.y&&(this.mFalling=!0))},Object.defineProperty(e.prototype,"status",{get:function(){return this.mStatus},enumerable:!1,configurable:!0}),e.prototype.playIdle=function(){this.mStatus=s.RoleStatus.Idle,this.playSpineAnimation(this.mSpine,s.Animations.Idle)},e.prototype.playIdleWatch=function(){this.mIsFever&&(this.mJumpRate=1,this.mIsFever=!1,clearTimeout(this.mFeverTimer),this.mFeverTimer=null,s.EventCenter.dispatchEvent(new s.default("feverComplete")),this.mFeverSpine.node.active=!1),this.mStatus=s.RoleStatus.Idle,this.playSpineAnimation(this.mSpine,s.Animations.IdleWatch)},e.prototype.playJump=function(){var t=this,e=!1;switch(this.mStatus){case s.RoleStatus.Run:this.mStatus=s.RoleStatus.Jump,this.playSpineAnimation(this.mSpine,s.Animations.Jump,!1,function(){t.playSpineAnimation(t.mSpine,s.Animations.JumpLoop)}),this.mJumping=!0,this.mJumpSpeed.y=s.GameConfig.RoleJumpSpeedY*this.mJumpRate,e=!0;break;case s.RoleStatus.PlatformRun:this.mStatus=s.RoleStatus.PlatformJump,this.playSpineAnimation(this.mSpine,s.Animations.Jump,!1,function(){t.playSpineAnimation(t.mSpine,s.Animations.JumpLoop)}),this.mJumping=!0,this.mJumpSpeed.y=s.GameConfig.RoleJumpSpeedY*this.mJumpRate,e=!0;break;case s.RoleStatus.Fever:this.mJumping||(this.mJumping=!0,this.mJumpSpeed.y=s.GameConfig.RoleJumpSpeedY*this.mJumpRate,e=!0)}return e},e.prototype.playRun=function(){this.mStatus=s.RoleStatus.Run,this.mSpine.timeScale=1,this.playSpineAnimation(this.mSpine,s.Animations.Run)},e.prototype.playFeverRun=function(){var t=this;this.mJumpRate=1.3,this.mFeverSpine.node.active=!0,s.EventCenter.dispatchEvent(new s.default("startFever")),this.mStatus=s.RoleStatus.Fever,this.mSpine.timeScale=1,this.playSpineAnimation(this.mSpine,s.Animations.FeverRun),this.mFeverTimer=setTimeout(function(){t.mIsFever&&(t.mJumpRate=1,t.mFeverSpine.node.active=!1,s.EventCenter.dispatchEvent(new s.default("feverComplete")),t.mIsFever=!1,t.playRun())},s.GameConfig.FeverDurationTime)},e.prototype.playPlatformRun=function(){this.mJumping=!1,this.mFalling=!1,this.mStatus=s.RoleStatus.PlatformRun,this.playSpineAnimation(this.mSpine,s.Animations.PlatformRun)},e.prototype.playCatch=function(){this.mJumping=!1,this.mFalling=!1,this.mStatus=s.RoleStatus.CatchRun,this.playSpineAnimation(this.mSpine,s.Animations.CatchRun,!0)},e.prototype.setFalling=function(t){void 0===t&&(t=!1),t&&(this.mJumpRate=1,s.EventCenter.dispatchEvent(new s.default("feverComplete")),this.mIsFever=!1,clearTimeout(this.mFeverTimer),this.mFeverTimer=null,this.mFeverSpine.node.active=!1),this.node.y>this.mBaseY&&(this.mJumpSpeed.y=0,this.mFalling=!0)},e.prototype.setFever=function(t){this.mIsFever=t,this.status==s.RoleStatus.Run&&this.playFeverRun()},e.prototype.onLanding=function(){this.mIsFever?this.playFeverRun():this.playRun()},e.prototype.playSpineAnimation=function(t,e,o,n,i){if(void 0===o&&(o=!0),void 0===i&&(i=!0),t){if(i&&t.animation==e)return void(n&&(n.apply(null),n=null));t.clearTracks(),t.setToSetupPose(),t.setAnimation(0,e,o),t.setCompleteListener(function(){n&&(n.apply(null),n=null)})}},r([c],e)}(cc.Component));o.default=l,cc._RF.pop()},{"./L2_W13_D2_G3_Config":"L2_W13_D2_G3_Config"}],L2_W13_D2_G3:[function(t,e,o){"use strict";cc._RF.push(e,"8ee54nqN+JAW7IuPDcp2wBn","L2_W13_D2_G3");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../module/component/feedBack/res/scripts/feedBackCtr"),a=t("../../../module/component/scripts/GameCompBase"),c=t("../../../module/kit/audio/AudioManager"),l=t("./L2_W13_D2_G3_Board"),p=t("./L2_W13_D2_G3_Collection"),u=t("./L2_W13_D2_G3_Config"),h=t("./L2_W13_D2_G3_ItemLayer"),d=t("./L2_W13_D2_G3_Map"),m=t("./L2_W13_D2_G3_MaskProgress"),f=t("./L2_W13_D2_G3_Platform"),_=t("./L2_W13_D2_G3_Role"),y=cc._decorator,v=y.ccclass,g=y.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roleNode=null,e.gameLayers=[],e.platforms=[],e.frontLayers=[],e.itemLayers=[],e.collections=[],e.collections2x=[],e.progressMask=[],e.powerMask=null,e.powerSpine=null,e.knowledge=null,e.Board=null,e.mRoundCompleted=!1,e}return i(e,t),e.prototype.onLoad=function(){var e=this;t.prototype.onLoad.call(this),this.initFeedBackComponent().then(function(t){e.mFeedBack=t}),this.initRecordComponent(),this.colliders=[],this.platforms.map(function(t){t.children.map(function(t){e.colliders.push(t.getChildByName("collider"))})}),this.gameLayers.map(function(t){t.getComponent(f.default).speed=12}),this.mPlatFormBaseX=-268},e.prototype.start=function(){t.prototype.start.call(this),this.mRole=this.roleNode.getComponentInChildren(_.default)},e.prototype.removeRecordComp=function(){var e=this;t.prototype.removeRecordComp.call(this),this.mGameIndex<u.GameConfig.Configs.length-1?(this.Board.hide(),this.resetGameData()):setTimeout(function(){e.gameEnd()},2e3)},e.prototype.update=function(){if(!u.GameConfig.GamePaused&&!this.mRoundCompleted){switch(this.mRole.status){case u.RoleStatus.PlatformRun:this.judgePlatformFall();break;case u.RoleStatus.CatchRun:this.judgeCatchFall();break;case u.RoleStatus.Jump:case u.RoleStatus.PlatformJump:this.judgeJumpCatch()}this.judgeCollection()}},e.prototype.onGameStart=function(){this.mGameIndex=-1,this.playSound(this.bundleName,"res/audios/"+u.Audios.Bgm,null,!1),this.playSound(this.bundleName,"res/audios/"+u.Audios.ClickAndListen,this.resetGameData.bind(this))},e.prototype.onDestroy=function(){t.prototype.onDestroy.call(this),this.delListener()},e.prototype.startGame=function(){var t=this;u.GameConfig.GamePaused=!1,this.mRole.playRun(),0==this.mGameIndex?setTimeout(function(){u.GameConfig.GamePaused=!0,t.guideByTypeShow(1),t.addListener()},400):this.addListener()},e.prototype.resetGameData=function(){var t=this;this.mRoundCompleted=!1,this.onFeverComplete(),this.mCurCollectNum=0,this.mGameIndex++,this.mGameData=u.GameConfig.Configs[this.mGameIndex];for(var e,o=0;o<this.gameLayers.length;o++)(e=this.gameLayers[o]).active=!0,e.x=0==o?this.mPlatFormBaseX:e.width+this.mPlatFormBaseX,e.getComponent(f.default).speed=12;this.progressMask.map(function(e,o){e.node.active=o==t.mGameIndex,e.node.active&&(t.mProgressMask=e)}),this.setCollectionImages(),setTimeout(function(){t.startGame()},1e3)},e.prototype.roundComplete=function(){var t=this;this.mRoundCompleted=!0,this.mTempFb&&(this.mTempFb.parent&&this.mTempFb.parent.removeChild(this.mTempFb),this.mTempFb=null),this.gameLayers.map(function(t){t.active=!1}),this.mRole.setFalling(!0),this.mCurCollider=null,this.Board.show(this.mGameData.knowledge,this.collections2x[this.mGameIndex],function(){u.GameConfig.GamePaused=!0,t.mRole.playIdleWatch(),t.record({text:t.mGameData.knowledge,soundsUrl:"res/audios/"+t.mGameData.audio,showImg:"res/images/board_"+t.mGameData.knowledge})})},e.prototype.addListener=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchEnd,this),u.EventCenter.on("showOtherPlatform",this.onShowOtherPlatform,this),u.EventCenter.on("onCollectPower",this.onCollectPower,this),u.EventCenter.on("onCollectKnowledge",this.showKnowledge,this),u.EventCenter.on("feverComplete",this.onFeverComplete,this),u.EventCenter.on("startFever",this.onStartFever,this)},e.prototype.delListener=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchEnd,this),u.EventCenter.off("showOtherPlatform",this.onShowOtherPlatform,this),u.EventCenter.off("onCollectPower",this.onCollectPower,this),u.EventCenter.off("onCollectKnowledge",this.showKnowledge,this),u.EventCenter.off("feverComplete",this.onFeverComplete,this),u.EventCenter.off("startFever",this.onStartFever,this)},e.prototype.onStartFever=function(){this.gameLayers.map(function(t){t.getComponent(f.default).speed=18}),this.frontLayers.map(function(t){t.getComponent(d.default).speed=18})},e.prototype.onFeverComplete=function(){this.gameLayers.map(function(t){t.getComponent(f.default).speed=12}),this.frontLayers.map(function(t){t.getComponent(d.default).speed=12}),this.mCurPowerNum=0,this.powerMask.progress=0,this.powerSpine.node.active=!1,this.mFever=!1},e.prototype.onCollectPower=function(){this.playSound(this.bundleName,"res/audios/"+u.Audios.Power),this.mCurPowerNum++;var t=this.mCurPowerNum/this.mGameData.totalPowerCount;t>=1&&(t=1,this.mFever||this.mRole.status!=u.RoleStatus.Jump&&this.mRole.status!=u.RoleStatus.Run||(this.powerSpine.node.active=!0,this.mFever=!0,this.mRole.setFever(!0),this.playSound(this.bundleName,"res/audios/"+u.Audios.Fever))),this.powerMask.progress=t},e.prototype.showKnowledge=function(t){var e,o=this,n=t.data,i=cc.instantiate(this.mFeedBack.node);this.gameLayers[0].x<cc.winSize.width/2-this.gameLayers[0].width?(e=this.gameLayers[0].convertToNodeSpaceAR(n),this.gameLayers[0].addChild(i)):(e=this.gameLayers[1].convertToNodeSpaceAR(n),this.gameLayers[1].addChild(i)),i.x=e.x,i.y=e.y,this.mTempFb=i,i.getComponent(s.default).showRightAnimation(cc.v3(e.x,e.y,0),function(){i.parent&&i.parent.removeChild(i),o.mTempFb=null}),this.mCurCollectNum++,this.mProgressMask&&(this.mProgressMask.progress=this.mCurCollectNum/this.mGameData.totalCollectCount),this.knowledge.node.active=!0,this.knowledge.node.opacity=0,this.knowledge.string=this.mGameData.knowledge,this.playSound(this.bundleName,"res/audios/"+this.mGameData.audio),cc.tween(this.knowledge.node).to(.3,{opacity:255},cc.easeCubicActionOut()).delay(2).call(function(){o.knowledge.node.active=!1}).start(),this.mCurCollectNum>=this.mGameData.totalCollectCount&&(this.delListener(),this.roundComplete())},e.prototype.setCollectionImages=function(){for(var t=0;t<this.itemLayers.length;t++)for(var e=this.itemLayers[t].getComponent(h.default).collections,o=0,n=null;o<e.length;o++)(n=e[o].getComponent(p.default)).resetNode(),0==n.type?n.setCollectionImage(this.collections[this.collections.length-1]):n.setCollectionImage(this.collections[this.mGameIndex])},e.prototype.onTouchEnd=function(){this.mRole.status!=u.RoleStatus.Fall&&this.mRole.status!=u.RoleStatus.CatchRun?(this.guideHide(),u.GameConfig.GamePaused=!1,this.roleNode.getComponentInChildren(_.default).playJump()&&this.playSound(this.bundleName,"res/audios/"+u.Audios.Jump)):cc.log("touch return "+this.mRole.status)},e.prototype.onShowOtherPlatform=function(t){var e=t.data;this.gameLayers.forEach(function(t){t==e&&t.getComponentInChildren(h.default).resetLayer()})},e.prototype.judgeCollection=function(){var t=this.mRole.node.getChildByName("collider").getBoundingBoxToWorld();this.itemLayers.forEach(function(e){e.active&&e.getComponent(h.default).collections.forEach(function(e){e.getComponent(p.default).checkCollection(t)})})},e.prototype.judgePlatformFall=function(){if(this.mCurCollider){var t=this.mCurCollider.getBoundingBoxToWorld(),e=this.mRole.node.convertToWorldSpaceAR(cc.Vec2.ZERO);t.xMax<e.x&&(this.mRole.setFalling(),this.mCurCollider=null,this.mFever&&this.mRole.setFever(!0))}},e.prototype.judgeJumpCatch=function(){var t=this;this.mFever||this.colliders.forEach(function(e){if(e.parent.active&&(!t.mCurCollider||t.mCurCollider!=e)){var o=e.getBoundingBoxToWorld(),n=void 0,i=void 0;e.parent.name.includes("Top")?(n=t.mRole.node.convertToWorldSpaceAR(cc.v2(60,160)),Math.abs(n.y-o.yMin)<=8&&n.x>=o.xMin-20&&n.x<o.xMax-20&&(t.mCurCollider=e,i=t.roleNode.convertToNodeSpaceAR(cc.v2(n.x,o.yMax)),t.mRole.playCatch(),t.mRole.node.x=i.x-60,t.mRole.node.y=i.y-160)):(n=t.mRole.node.convertToWorldSpaceAR(cc.Vec2.ZERO),Math.abs(n.y-o.yMax)<=8&&n.x>=o.xMin-20&&n.x<o.xMax-20&&(t.mRole.playPlatformRun(),t.mCurCollider=e,i=t.roleNode.convertToNodeSpaceAR(cc.v2(n.x,o.yMax)),t.mRole.node.x=i.x,t.mRole.node.y=i.y))}})},e.prototype.judgeCatchFall=function(){if(this.mCurCollider){var t=this.mCurCollider.getBoundingBoxToWorld(),e=this.mRole.node.convertToWorldSpaceAR(cc.v2(60,160));t.xMax<e.x&&(this.mRole.setFalling(),this.mCurCollider=null,this.mFever&&this.mRole.setFever(!0))}},e.prototype.playSound=function(t,e,o,n){void 0===o&&(o=null),void 0===n&&(n=!0),n?c.default.playEffect(t,e,function(){o&&(o.apply(null),o=null)}):c.default.playMusic(t,e)},r([g({type:cc.Node,tooltip:"\u89d2\u8272\u8282\u70b9"})],e.prototype,"roleNode",void 0),r([g({type:[cc.Node],tooltip:"\u6e38\u620f\u5c42"})],e.prototype,"gameLayers",void 0),r([g({type:[cc.Node],tooltip:""})],e.prototype,"platforms",void 0),r([g({type:[cc.Node],tooltip:"\u524d\u666f\u5c42"})],e.prototype,"frontLayers",void 0),r([g({type:[cc.Node],tooltip:""})],e.prototype,"itemLayers",void 0),r([g({type:[cc.SpriteFrame],tooltip:"\u6536\u96c6\u7269icon"})],e.prototype,"collections",void 0),r([g({type:[cc.SpriteFrame],tooltip:"\u6536\u96c6\u7269\u5927icon"})],e.prototype,"collections2x",void 0),r([g({type:[m.default],tooltip:"\u5173\u5361\u6536\u96c6\u8fdb\u5ea6"})],e.prototype,"progressMask",void 0),r([g(m.default)],e.prototype,"powerMask",void 0),r([g(sp.Skeleton)],e.prototype,"powerSpine",void 0),r([g(cc.Label)],e.prototype,"knowledge",void 0),r([g(l.default)],e.prototype,"Board",void 0),r([v],e)}(a.default);o.default=C,cc._RF.pop()},{"../../../module/component/feedBack/res/scripts/feedBackCtr":void 0,"../../../module/component/scripts/GameCompBase":void 0,"../../../module/kit/audio/AudioManager":void 0,"./L2_W13_D2_G3_Board":"L2_W13_D2_G3_Board","./L2_W13_D2_G3_Collection":"L2_W13_D2_G3_Collection","./L2_W13_D2_G3_Config":"L2_W13_D2_G3_Config","./L2_W13_D2_G3_ItemLayer":"L2_W13_D2_G3_ItemLayer","./L2_W13_D2_G3_Map":"L2_W13_D2_G3_Map","./L2_W13_D2_G3_MaskProgress":"L2_W13_D2_G3_MaskProgress","./L2_W13_D2_G3_Platform":"L2_W13_D2_G3_Platform","./L2_W13_D2_G3_Role":"L2_W13_D2_G3_Role"}]},{},["L2_W13_D2_G3","L2_W13_D2_G3_Board","L2_W13_D2_G3_Collection","L2_W13_D2_G3_Config","L2_W13_D2_G3_ItemLayer","L2_W13_D2_G3_Light","L2_W13_D2_G3_Map","L2_W13_D2_G3_MaskProgress","L2_W13_D2_G3_Platform","L2_W13_D2_G3_Role"]);