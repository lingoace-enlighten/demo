window.__require=function t(e,o,n){function i(r,s){if(!o[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var p="function"==typeof __require&&__require;if(!s&&p)return p(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var l=o[r]={exports:{}};e[r][0].call(l.exports,function(t){return i(e[r][1][t]||t)},l,l.exports,t,e,o,n)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<n.length;r++)i(n[r]);return i}({WaterItem:[function(t,e,o){"use strict";cc._RF.push(e,"0f579SGoiJEvLdSJ3NIJIyA","WaterItem");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../module/kit/event/ListenerManager"),s=t("./WaterPipeConfig"),c=cc._decorator,p=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skPip=null,e.labelAlphabet=null,e.nodeMask=null,e.strAlphabet="",e.isCanTouch=!0,e}return i(e,t),e.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.Init=function(t,e){this.labelAlphabet.string=t,this.strAlphabet=t,this.isCanTouch=e},e.prototype.SetTouchState=function(t){this.isCanTouch=t,this.nodeMask.active=!t},e.prototype.onTouchStart=function(t){if(this.isCanTouch){var e=this.node.getParent().convertToNodeSpaceAR(t.getLocation());this.node.setPosition(e),r.ListenerManager.dispatch(s.WaterPipEnum.TOUCH_START,this,this.strAlphabet,t)}},e.prototype.onTouchMove=function(t){if(this.isCanTouch){var e=this.node.getParent().convertToNodeSpaceAR(t.getLocation());this.node.setPosition(e),r.ListenerManager.dispatch(s.WaterPipEnum.TOUCH_MOVE,this,this.strAlphabet,t)}},e.prototype.onTouchEnd=function(t){if(this.isCanTouch){var e=this.node.getParent().convertToNodeSpaceAR(t.getLocation());this.node.setPosition(e),r.ListenerManager.dispatch(s.WaterPipEnum.TOUCH_END,this,this.strAlphabet,t)}},a([l({type:sp.Skeleton,displayName:"spine\u52a8\u753b"})],e.prototype,"skPip",void 0),a([l({type:cc.Label,displayName:"\u5b57\u6bcd"})],e.prototype,"labelAlphabet",void 0),a([l({type:cc.Node,displayName:"\u7070\u8272\u906e\u7f69"})],e.prototype,"nodeMask",void 0),a([p],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../module/kit/event/ListenerManager":void 0,"./WaterPipeConfig":"WaterPipeConfig"}],WaterLevel:[function(t,e,o){"use strict";cc._RF.push(e,"e8605U0+bdKJZ411SAKijzh","WaterLevel");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../module/component/scripts/MathEx"),s=t("../../../module/component/scripts/SpineUtils"),c=t("../../../module/kit/event/ListenerManager"),p=t("./WaterItem"),l=t("./WaterPipeConfig"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeTouch=null,e.nodeShow=null,e.nodeListLineParent=null,e.num_step=0,e.num_level=0,e.listPop=[],e.listNowPop=[],e.listNowLine=[],e.listAlphabet=[],e}return i(e,t),e.prototype.start=function(){this.listPop=this.nodeShow.children;for(var t=0;t<this.listPop.length;t++)this.listPop[t].children.map(function(t){return t.active=!1});var e=this.nodeListLineParent.children;for(t=0;t<e.length;t++)e[t].active=!0,e[t].children.map(function(t){return t.active=!0})},e.prototype.InitData=function(t,e){var o=this;void 0===e&&(e=0),this.num_level=t,this.num_step=e,this.listAlphabet=[],this.listAlphabet=l.default.instance.listAlphabetAudio[t],this.listNowPop=[],this.listNowPop=this.listPop[t].children;for(var n=0,i=this.listNowPop.length;n<i;n++)this.listNowPop[n].getChildByName("waPian").getChildByName("Alphabet").getComponent(cc.Label).string=this.listAlphabet[n];this.listNowLine=[],this.listNowLine=this.nodeListLineParent.children[t].children;var a=this.nodeTouch.children;a.map(function(e,n){e.active=!1,e.setPosition(cc.Vec2.ZERO);var i=l.default.instance.listUnlockStep[t][n]-1;e.getChildByName("waPian").getChildByName("Alphabet").getComponent(cc.Label).string=o.listAlphabet[i],e.getComponent(p.default).Init(o.listAlphabet[i],!0)}),this.nodeTouch.setPosition(l.default.instance.listSelectNodePos[t]),a[l.default.instance.listUnlockStep[t][e]-1].active=!0},e.prototype.placeFinish=function(t){this.listNowLine[t].active=!1;var e=this.listNowPop[t].children[0].getComponent(sp.Skeleton);this.listNowPop[t].active=!0,this.nodeTouch.children.map(function(t){return t.active=!1}),c.ListenerManager.dispatch(l.WaterPipEnum.PLAY_EFFECT,"SE_jieshuiguan_02"),s.SpineUtils.playSpine(e,1,!1,function(){c.ListenerManager.dispatch(l.WaterPipEnum.STOP_EFFECT,"SE_jieshuiguan_02")}),this.num_step=t+1,this.num_step<3&&this.setTouchNodeShow(this.num_step)},e.prototype.setTouchNodeShow=function(t){var e=this.nodeTouch.children;e.map(function(t){return t.active=!1}),this.nodeTouch.setPosition(l.default.instance.listSelectNodePos[this.num_level]),e[l.default.instance.listUnlockStep[this.num_level][t]-1].active=!0},e.prototype.collisionDetection=function(t){var e=this.listNowLine[this.num_step],o=e.getParent().convertToNodeSpaceAR(t.convertToWorldSpaceAR(cc.Vec2.ZERO));return r.MathEx.Collision(o,t.getContentSize(),e.getPosition(),e.getContentSize())},a([h({type:cc.Node,displayName:"\u62d6\u62fd\u8282\u70b9"})],e.prototype,"nodeTouch",void 0),a([h({type:cc.Node,displayName:"\u663e\u793a\u7684\u8282\u70b9"})],e.prototype,"nodeShow",void 0),a([h({type:cc.Node,displayName:"line"})],e.prototype,"nodeListLineParent",void 0),a([d],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../module/component/scripts/MathEx":void 0,"../../../module/component/scripts/SpineUtils":void 0,"../../../module/kit/event/ListenerManager":void 0,"./WaterItem":"WaterItem","./WaterPipeConfig":"WaterPipeConfig"}],WaterPipeConfig:[function(t,e,o){"use strict";cc._RF.push(e,"fb2e1q1SsNKxpfQ3iZTtWeg","WaterPipeConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.WaterPopSpineName=o.WaterPipEnum=void 0;var n=function(){function t(){this.numMaxLevel=4,this.listWord=["map","rag","mat","van"],this.listAudio=["map","rag","mat","van"],this.listAlphabetAudio=[],this.listUnlockStep=[[1,2,3],[3,2,1],[2,1,3],[3,2,1]],this.listBgMovePos=[cc.v2(150,0),cc.v2(-600,0),cc.v2(-1700,0),cc.v2(-2680,0)],this.listSelectNodePos=[cc.v2(-0,-286),cc.v2(397,201),cc.v2(-0,-286),cc.v2(8,214)]}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.wordSplice=function(){this.listAlphabetAudio=[];for(var t=0,e=this.listAudio.length;t<e;t++){var o=this.listAudio[t].split("");this.listAlphabetAudio.push(o)}},t._instance=null,t}();o.default=n,function(t){t.TOUCH_START="TOUCH_START",t.TOUCH_MOVE="TOUCH_MOVE",t.TOUCH_END="TOUCH_END",t.PLAY_EFFECT="PLAY_EFFECT",t.STOP_EFFECT="STOP_EFFECT"}(o.WaterPipEnum||(o.WaterPipEnum={})),o.WaterPopSpineName||(o.WaterPopSpineName={}),cc._RF.pop()},{}],WaterPip:[function(t,e,o){"use strict";cc._RF.push(e,"46cfaRiJuNDRI/yLYV2YiQl","WaterPip");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../module/component/scripts/AnimationEx"),s=t("../../../module/component/scripts/GameCompBase"),c=t("../../../module/kit/audio/AudioManager"),p=t("../../../module/kit/event/ListenerManager"),l=t("./WaterLevel"),u=t("./WaterPipeConfig"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeBg=null,e.nodeMask=null,e.nodeWordCard=null,e.nodeParent=null,e.nodeTransition=null,e.nodeContent=null,e.skRight=null,e.compWaterLevel=null,e.audioBg=null,e.compHandCtr=null,e.num_step=0,e.num_nowLevel=0,e.num_maxLevel=0,e.num_waitTime=5,e.bool_isWaitStart=!1,e}return i(e,t),e.prototype.start=function(){var e=this;this.setMask(!0),this.num_maxLevel=u.default.instance.numMaxLevel-1,this.addEvent(),this.initHandComponent(1).then(function(o){e.compHandCtr=o,e.compHandCtr.node.setParent(e.nodeContent),e.compHandCtr.node.setPosition(cc.v2(-379,-293)),e.compHandCtr.node.active=!1,t.prototype.start.call(e)})},e.prototype.onGameStart=function(){var t=this;this.audioBg.play(),u.default.instance.wordSplice(),this.PlayWaterPopAnim(0).then(function(){return t.compWaterLevel.InitData(t.num_nowLevel),t.playEffect("drag_and_listen")}).then(function(){t.compHandCtr.TouchCycle(cc.v2(-0,-286),cc.v2(-238,-46)),t.compHandCtr.node.active=!0,t.scheduleOnce(function(){t.setMask(!1)},.5)}),this.schedule(this.playTip,1)},e.prototype.addEvent=function(){p.ListenerManager.on(u.WaterPipEnum.TOUCH_START,this.onTouchStart,this),p.ListenerManager.on(u.WaterPipEnum.TOUCH_MOVE,this.onTouchMove,this),p.ListenerManager.on(u.WaterPipEnum.TOUCH_END,this.onTouchEnd,this),p.ListenerManager.on(u.WaterPipEnum.PLAY_EFFECT,this.playEffect,this),p.ListenerManager.on(u.WaterPipEnum.STOP_EFFECT,this.stopEffect,this)},e.prototype.onTouchStart=function(t,e){this.compHandCtr.node.active=!1,this.playLoopEffect(e),this.bool_isWaitStart=!1},e.prototype.onTouchMove=function(){},e.prototype.onTouchEnd=function(t,e){var o=this;this.stopLoopEffect(e),this.setMask(!0),this.compWaterLevel.collisionDetection(t.node)?(this.compWaterLevel.placeFinish(this.num_step),this.PlayRight(t.node.convertToWorldSpaceAR(cc.Vec2.ZERO)).then(function(){return o.playAudioSound(e)}).then(function(){o.num_step+=1,3==o.num_step?o.playKaAnimation(o.num_nowLevel).then(function(){o.playAudioSound(u.default.instance.listAudio[o.num_nowLevel]).then(function(){o.nodeWordCard.active=!1,o.num_nowLevel+=1,o.num_nowLevel<=o.num_maxLevel?(o.setNextLevelData(o.num_nowLevel),o.PlayLevelTransitionAnimation(o.num_nowLevel)):o.PlayWaterPopAnim(4).then(function(){return o.playEffect("well_done")}).then(function(){o.gameEnd()})})}):o.scheduleOnce(function(){o.setMask(!1),o.bool_isWaitStart=!0,o.num_waitTime=5},.5)})):(this.setMask(!1),this.bool_isWaitStart=!0,this.num_waitTime=5),t.node.setPosition(cc.Vec2.ZERO)},e.prototype.setMask=function(t){t?this.nodeMask.setPosition(cc.Vec2.ZERO):this.nodeMask.setPosition(cc.v2(0,9999))},e.prototype.setNextLevelData=function(){this.compWaterLevel.InitData(this.num_nowLevel,0),this.num_step=0},e.prototype.PlayLevelTransitionAnimation=function(t){var e=this;return new Promise(function(o){e.PlayWaterPopAnim(t),e.compWaterLevel.nodeTouch.active=!1;var n=u.default.instance.listBgMovePos[t];r.AnimationEx.MoveAnimation(e.nodeBg,e.nodeBg.getPosition(),n,1).then(function(){e.compWaterLevel.nodeTouch.active=!0,e.setMask(!1),e.bool_isWaitStart=!0,e.num_waitTime=5,o(null)})})},e.prototype.PlayWaterPopAnim=function(t){var e=this,o=this.nodeTransition.children[t].getComponent(sp.Skeleton),n=["kaishidonghua","xianjiechu_1","xianjiechu_2","xianjiechu_3","jieweidonghua"];return new Promise(function(i){e.playEffect("SE_jieshuiguan_02"),e.playSpineAsync(o,n[t],!1).then(function(){return e.stopEffect("SE_jieshuiguan_02"),i(null)})})},e.prototype.PlayRight=function(t){var e=this;return new Promise(function(o){e.playEffect("game_right");var n=e.nodeParent.convertToNodeSpaceAR(t);e.skRight.node.setPosition(n),e.skRight.node.active=!0,r.AnimationEx.playSpine(e.skRight,"13_1_zhengfangti xiaoshixiaoguo",!1).then(function(){e.skRight.node.active=!1,o(null)})})},e.prototype.playKaAnimation=function(t){var e=this;return new Promise(function(o){e.setKa(t,!0),e.nodeWordCard.scale=0,cc.tween(e.nodeWordCard).set({opacity:0,scale:0}).to(1,{opacity:255,scale:.5},{easing:"elasticOut"}).call(function(){o(null)}).start()})},e.prototype.setKa=function(t,e){this.nodeWordCard.children.map(function(t,e){0!=e&&(t.active=!1)}),this.nodeWordCard.active=e,this.nodeWordCard.children[0].getComponent(cc.Label).string=u.default.instance.listAudio[this.num_nowLevel],this.nodeWordCard.children[t+1].active=e},e.prototype.playEffect=function(t){var e=this;return new Promise(function(o){var n="res/audios/"+t;c.default.playEffect(e.bundleName,n,function(){o(null)})})},e.prototype.playAudioSound=function(t){var e=this;return new Promise(function(o){var n="res/audios/"+t;c.default.playAudioSound(e.bundleName,n,function(){o(null)})})},e.prototype.playLoopEffect=function(t){var e="res/audios/"+t;c.default.playLoopEffect(this.bundleName,e)},e.prototype.stopLoopEffect=function(t){var e="res/audios/"+t;c.default.stopLoopEffect(this.bundleName,e)},e.prototype.stopEffect=function(t){var e="res/audios/"+t;c.default.stopEffectByName(this.bundleName,e)},e.prototype.playTip=function(){var t=this;this.bool_isWaitStart&&(this.num_waitTime-=1,this.num_waitTime<=0&&(this.bool_isWaitStart=!1,this.num_waitTime=5,r.AnimationEx.playTipAnimation(this.compWaterLevel.nodeTouch),this.scheduleOnce(function(){t.bool_isWaitStart=!0,t.num_waitTime=5},1)))},a([f({type:cc.Node,displayName:"bg"})],e.prototype,"nodeBg",void 0),a([f({type:cc.Node,displayName:"mask"})],e.prototype,"nodeMask",void 0),a([f({type:cc.Node,displayName:"\u5355\u8bcd\u5361"})],e.prototype,"nodeWordCard",void 0),a([f({type:cc.Node,displayName:"\u53cd\u9988\u7684\u7236\u8282\u70b9"})],e.prototype,"nodeParent",void 0),a([f({type:cc.Node,displayName:"\u8fc7\u5ea6\u6c34\u7ba1"})],e.prototype,"nodeTransition",void 0),a([f({type:cc.Node,displayName:"\u6e38\u620f\u5185\u5bb9\u653e\u7f6e\u70b9"})],e.prototype,"nodeContent",void 0),a([f({type:sp.Skeleton,displayName:"\u661f\u661fspine"})],e.prototype,"skRight",void 0),a([f({type:l.default,displayName:"\u6c34\u7ba1\u5173\u5361"})],e.prototype,"compWaterLevel",void 0),a([f({type:cc.AudioSource,displayName:"\u80cc\u666f\u97f3\u4e50"})],e.prototype,"audioBg",void 0),a([h],e)}(s.default);o.default=m,cc._RF.pop()},{"../../../module/component/scripts/AnimationEx":void 0,"../../../module/component/scripts/GameCompBase":void 0,"../../../module/kit/audio/AudioManager":void 0,"../../../module/kit/event/ListenerManager":void 0,"./WaterLevel":"WaterLevel","./WaterPipeConfig":"WaterPipeConfig"}]},{},["WaterItem","WaterLevel","WaterPip","WaterPipeConfig"]);