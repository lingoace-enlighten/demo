{"version":3,"sources":["assets/GameListenLong/scripts/GameListenLong.ts","assets/GameListenLong/res/hand/script/HandCtr.ts"],"names":["HandCtr_1","require","_a","cc","_decorator","ccclass","property","GameSnailPaShan","_super","__extends","_this","apply","this","arguments","arrAudioCom","arrAudioRight","arrAudioTitle","arrAudioSpine","nodeLong","nodeRole","arrQues","btnElse","skeletonRole","skeletonLaba","isLock","isFinish","quesIndex","selectItems","pageNum","event_game_next","event_game_sound","event_game_touch","event_game_end","reDebug","isTeacher","tiptimeCount","tipTimeMax","tipState","dataQues","options","title","scaleType","delay","scaleTo","scaleLong","scaleRole","dataSpine","prototype","onDisable","kit","AudioPlayer","stopAll","onDestroy","call","sendMessage","start","setIsLock","initData","resetData","updateUI","nextQuestion","update","dt","tipShow","_data","content","actionData","cmd","info","page","refreshDataForMsg","result","updateDataForMsg","window","sessionStorage","removeItem","updateUIForQues","updateUIForSpine","selectNum","length","index","element","active","playAnimation","tipStart","_loop_1","this_1","hand","getChildByName","script_1","getComponent","default","count_1","number_1","funcHand_1","Click","tipHide","_loop_2","this_2","opacity","tween","to","dataOne","funcHello","callBack","playEffect","playAniArray","funcTitle","scaleObj","timeDis","scaleDis","timeLong","timeRole","timeDelay","node","scale","playAniSound","scheduleOnce","eventElse","itemId","msgResultElse","playAniWrong","bind","eventSound","msgResultSound","eventTouch","_event","indexOf","target","parent","msgResultTouch","playAniWin","playAniSuccess","arrSpine","funcRight","rightId","Math","floor","random","push","object","handleData","key","Object","hasOwnProperty","tempData","receiveMessage","postMessage","JSON","stringify","skeleton","aniName","isLoop","timeScale","setToSetupPose","clearTracks","setCompleteListener","entry","setAnimation","setParams","data","log","setContent","__decorate","AudioClip","Node","sp","Skeleton","Component","exports","HandSpineAnimationName","ApertureAnimationName","HandCtr","skAperture","skHand","arrow","arrowWidth","onEnable","stopAllActions","width","unscheduleAllCallbacks","Press","callback","playSpine","danji","dianji","Lift","taishou","ClickCycle","schedule","macro","REPEAT_FOREVER","ClickCycleByScale","mScale","speed","TouchAnimation","starPos","endPos","time","setPosition","position","v3","x","y","MoveWithPosList","nxetPosList","allMove","v","move","Promise","resolve","reject","pos","_i","nxetPosList_1","queue","arr","sequence","forEach","item","then","res","TouchCycle","waitTime","runTime","abs","arrowHeight","dir","sub","angle","signAngle","v2","degree","PI","sqrt","stopCycleAllAction","Tween","stopAllByTarget","wipeCycle","len","mag","repeatForever","spNode","spName","loop","track","trackEntry","loopCount","name","animation","type","displayName"],"mappings":"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","sourcesContent":["import HandCtr from '../res/hand/script/HandCtr';\n\nconst { ccclass, property } = cc._decorator;\n@ccclass\nexport default class GameSnailPaShan extends cc.Component implements center.ISubGame {\n\n    @property([cc.AudioClip])\n    arrAudioCom: cc.AudioClip[] = [];// 0:打招呼 1:负反馈 2:负反馈 3:结束\n\n    @property([cc.AudioClip])\n    arrAudioRight: cc.AudioClip[] = [];// 答对音效\n\n    @property([cc.AudioClip])\n    arrAudioTitle: cc.AudioClip[] = [];// 题目音频\n\n    @property([cc.AudioClip])\n    arrAudioSpine: cc.AudioClip[] = [];// 答对\n\n    @property(cc.Node)\n    nodeLong: cc.Node = null;// 负反馈按钮\n\n    @property(cc.Node)\n    nodeRole: cc.Node = null;// 负反馈按钮\n\n    @property([cc.Node])\n    arrQues: cc.Node[] = [];// 操作项\n\n    @property(cc.Node)\n    btnElse: cc.Node = null;// 负反馈按钮\n\n    @property(sp.Skeleton)\n    skeletonRole: sp.Skeleton = null;// 角色spine\n\n    @property(sp.Skeleton)\n    skeletonLaba: sp.Skeleton = null;// 喇叭spine\n\n    isLock: boolean = false;// 锁定状态标识：锁定时，不能进行操作\n    isFinish: boolean = false;// 游戏结束标识\n    quesIndex: number = 0;// 题目\n    selectItems: number[] = [];// 答题状况\n    pageNum: number = 0;// 游戏在课件内的页数\n\n    /** 事件 */\n    event_game_next: string = 'EVENT_GAME_NEXT';\n    event_game_sound: string = 'EVENT_GAME_SOUND';\n    event_game_touch: string = 'EVENT_GAME_TOUDH';\n    event_game_end: string = 'EVENT_GAME_END';\n\n    /** 大厅相关 */\n    reDebug: boolean = false;\n    bundleName: string;\n    content: center.IContent;\n    isTeacher: boolean = this.reDebug ? true : false;\n\n    /** 提示 */\n    tiptimeCount: number = 0;\n    tipTimeMax: number = 5;\n    tipState: number = 0; // 0:计时状态  1:播放状态\n\n    /** \n     * 游戏数据 \n     * showType 1:节点nodeLong放大  2:节点nodeRole放大 \n     * */\n    dataQues = {\n        options: [\n            { title: '鼻子', scaleType: 0, delay: 0.8 },\n            { title: '眼睛', scaleType: 0, delay: 0.1 },\n            { title: '嘴巴', scaleType: 0, delay: 0.1 },\n            { title: '耳朵', scaleType: 0, delay: 0.4 },\n            { title: '头发', scaleType: 0, delay: 0.1 },\n            { title: '脚', scaleType: 1, delay: 0.1 },\n        ],\n        scaleTo: [\n            { scaleLong: 2, scaleRole: 1 },\n            { scaleLong: 1, scaleRole: 2 }\n        ],\n        dataSpine: [\n            ['daiji', 'guzhang', 'xuanyun', 'hello'],\n            ['bizi', 'yanjing', 'zuiba', 'erduo', 'toufa', 'jiao'],\n            ['daiji', 'bobao'],\n        ],\n    };\n\n    onDisable(): void {\n        kit.AudioPlayer.stopAll();\n    }\n\n    onDestroy(): void {\n        super.onDestroy();\n        this.sendMessage(this.event_game_end, {});\n    }\n\n    start(): void {\n        this.setIsLock(true);\n        // 初始化数据\n        this.initData();\n        // 重置数据\n        this.resetData();\n        // 刷新ui\n        this.updateUI();\n        // 进入下一题\n        this.nextQuestion();\n    }\n\n    update(dt): void {\n        if (this.isFinish) {\n            return;\n        }\n        if (this.tipState === 0) {\n            this.tiptimeCount += dt;\n            if (this.tiptimeCount >= this.tipTimeMax) {\n                this.tiptimeCount = 0;\n                this.tipState = 1;\n                this.tipShow();\n            }\n        }\n    }\n\n    /** 初始化数据 */\n    initData(): void { }\n\n    /** 重置数据 */\n    resetData(): void {\n        var _data = this.content && this.content['getSnapshot'] ? this.content['getSnapshot']() : {};\n        if (_data) {\n            _data = _data.actionData;\n        }\n        // 断线重连测试\n        // let msg = [\n        //     {\"cmd\":\"EVENT_GAME_TOUDH\",\"page\":0,\"info\":{\"itemId\":0,\"result\":true,\"quesIndex\":0,\"selectItems\":[]}},\n        //     {\"cmd\":\"EVENT_GAME_TOUDH\",\"page\":0,\"info\":{\"itemId\":1,\"result\":true,\"quesIndex\":0,\"selectItems\":[0]}},\n        //     {\"cmd\":\"EVENT_GAME_TOUDH\",\"page\":0,\"info\":{\"itemId\":2,\"result\":true,\"quesIndex\":0,\"selectItems\":[0,1]}},\n        //     {\"cmd\":\"EVENT_GAME_TOUDH\",\"page\":0,\"info\":{\"itemId\":3,\"result\":true,\"quesIndex\":0,\"selectItems\":[0,1,2]}},\n        //     {\"cmd\":\"EVENT_GAME_TOUDH\",\"page\":0,\"info\":{\"itemId\":4,\"result\":true,\"quesIndex\":0,\"selectItems\":[0,1,2,3]}},\n        //     {\"cmd\":\"EVENT_GAME_TOUDH\",\"page\":0,\"info\":{\"itemId\":5,\"result\":true,\"quesIndex\":0,\"selectItems\":[0,1,2,3,4]}},\n        // ];\n        // _data = msg[5];\n        if (_data\n            && _data.cmd && _data.cmd != this.event_game_end\n            && _data.info\n            && _data.page == this.pageNum) {\n            let info = _data.info;\n            this.refreshDataForMsg(info);\n            if (_data.cmd === this.event_game_touch) {\n                if (info.result) {\n                    this.updateDataForMsg(info);\n                }\n            }\n            window.sessionStorage.removeItem(\"workInfoList\");\n        }\n    }\n\n    /** 刷新ui */\n    updateUI(): void {\n        this.updateUIForQues();\n        this.updateUIForSpine();\n    }\n\n    /** 更新问题ui */\n    updateUIForQues(): void {\n        let selectNum = this.selectItems.length;\n        for (let index = 0, length = this.arrQues.length; index < length; index++) {\n            const element = this.arrQues[index];\n            element.active = index === selectNum;\n        }\n    }\n\n    /** 更新spineUi */\n    updateUIForSpine(): void {\n        let dataSpine = this.dataQues.dataSpine;\n        this.playAnimation(this.skeletonRole, dataSpine[0][0], true, 1, null);\n        this.playAnimation(this.skeletonLaba, dataSpine[2][0], true, 1, null);\n    }\n\n    /** 小手提示：开始记时 */\n    tipStart(): void {\n        this.tipState = 0;\n        this.tiptimeCount = 0;\n    }\n\n    /** 小手提示：显示 */\n    tipShow(): void {\n        this.tipState = 1;\n        for (let index = 0, length = this.arrQues.length; index < length; index++) {\n            const element = this.arrQues[index];\n            if (element.active) {\n                let hand = element.getChildByName('hand');\n                hand.active = true;\n                let script = hand.getComponent(HandCtr);\n                let count = 0, number = 3;\n                let funcHand = () => {\n                    if (count < number) {\n                        count++;\n                        script.Click(funcHand);\n                    }\n                    else {\n                        this.tipHide();\n                        this.tipStart();\n                    }\n                };\n                funcHand();\n            }\n        }\n    }\n\n    /** 小手提示：隐藏 */\n    tipHide(): void {\n        this.tipState = 1;\n        for (let index = 0, length = this.arrQues.length; index < length; index++) {\n            const element = this.arrQues[index];\n            let hand = element.getChildByName('hand');\n            if (element.active && hand.active) {\n                hand.active = true;\n                hand.opacity = 255;\n                cc.tween(hand).to(0.3, { opacity: 0 }).call(() => {\n                    hand.opacity = 255;\n                    hand.active = false;\n                }).start();\n            }\n        }\n    }\n\n    /** 进入下一题 */\n    nextQuestion(): void {\n        if (this.isFinish) return;\n        this.tipHide();\n\n        let selectNum = this.selectItems.length;\n        let dataOne = this.dataQues.options[selectNum];\n        let dataSpine = this.dataQues.dataSpine;\n        // 打招呼\n        let funcHello = (callBack) => {\n            kit.AudioPlayer.playEffect(this.arrAudioCom[0]);\n            this.playAniArray(this.skeletonRole, 0, [dataSpine[0][3], dataSpine[0][0]], callBack);\n        };\n\n        // 播报题目\n        let funcTitle = () => {\n            let scaleObj = this.dataQues.scaleTo[dataOne.scaleType];\n            let timeDis = 0.5, scaleDis = 2;\n            let timeLong = scaleObj.scaleLong * timeDis / scaleDis;\n            let timeRole = scaleObj.scaleRole * timeDis / scaleDis;\n            let timeDelay = scaleObj.scaleLong > 1 || scaleObj.scaleRole > 1 ? 0.5 : 0.1;\n            cc.tween(this.node).call(() => {\n                cc.tween(this.nodeLong).to(timeLong, { scale: scaleObj.scaleLong }).start();\n            }).delay(timeLong).call(() => {\n                cc.tween(this.nodeRole).to(timeRole, { scale: scaleObj.scaleRole }).start();\n            }).delay(timeRole + timeDelay).call(() => {\n                this.playAniSound();\n            }).start();\n        };\n\n        if (selectNum > 0) {\n            funcTitle();\n        }\n        else {\n            let timeDelay = 0.5;\n            this.scheduleOnce(() => { funcHello(funcTitle); }, timeDelay);\n        }\n    }\n\n    /** 事件：点击其他 */\n    eventElse(): void {\n        if (this.isLock) return;\n        this.setIsLock(true);\n        this.sendMessage(this.event_game_next, { itemId: 0, result: false });\n    }\n\n    /** 回掉：点击其他 */\n    msgResultElse(_data: any): void {\n        this.setIsLock(true);\n        this.refreshDataForMsg(_data);\n        this.playAniWrong(this.playAniSound.bind(this));\n    }\n\n    /** 事件：点击声音 */\n    eventSound(): void {\n        if (this.isLock) return;\n        this.setIsLock(true);\n        this.sendMessage(this.event_game_sound, { itemId: 0, result: true });\n    }\n\n    /** 回掉：点击声音 */\n    msgResultSound(_data: any): void {\n        this.setIsLock(true);\n        this.refreshDataForMsg(_data);\n        this.playAniSound();\n    }\n\n    /** 事件：点击选项 */\n    eventTouch(_event: cc.Event): void {\n        if (this.isLock) return;\n        let itemId = this.arrQues.indexOf(_event.target.parent);\n        // 点击异常\n        if (itemId < 0 || this.selectItems.indexOf(itemId) >= 0) {\n            return;\n        }\n        this.setIsLock(true);\n        this.sendMessage(this.event_game_touch, { itemId: itemId, result: true });\n    }\n\n    /** 回掉：点击选项 */\n    msgResultTouch(_data: any): void {\n        this.setIsLock(true);\n        this.refreshDataForMsg(_data);\n        let callBack = () => {\n            this.updateDataForMsg(_data);\n            if (this.isFinish) {\n                this.playAniWin();\n            }\n            else {\n                this.updateUIForQues();\n                this.nextQuestion();\n            }\n        };\n        this.playAniSuccess(callBack);\n    }\n\n    playAniSuccess(callBack: Function): void {\n        let selectNum = this.selectItems.length;\n        let dataSpine = this.dataQues.dataSpine;\n        let arrSpine = [dataSpine[1][selectNum], dataSpine[0][1], dataSpine[0][0]];\n        let funcRight = () => {\n            kit.AudioPlayer.stopAll();\n            let rightId = Math.floor(Math.random() * 3);\n            kit.AudioPlayer.playEffect(this.arrAudioRight[rightId]);\n            this.playAniArray(this.skeletonRole, 0, [arrSpine[1], arrSpine[2]], () => {\n                this.scheduleOnce(callBack, 1.0);\n            });\n        };\n\n        let dataOne = this.dataQues.options[selectNum];\n        cc.tween(this.node).delay(dataOne.delay).call(() => {\n            kit.AudioPlayer.playEffect(this.arrAudioSpine[selectNum]);\n        }).start();\n        this.playAnimation(this.skeletonRole, arrSpine[0], false, 1, funcRight);\n    }\n\n    playAniWrong(callBack: Function): void {\n        kit.AudioPlayer.playEffect(this.arrAudioCom[1]);\n        let dataSpine = this.dataQues.dataSpine;\n        let arrSpine = [dataSpine[0][2], dataSpine[0][0]];\n        this.playAniArray(this.skeletonRole, 0, arrSpine, () => {\n            cc.tween(this.node).delay(0.8).call(() => {\n                kit.AudioPlayer.playEffect(this.arrAudioCom[2]);\n            }).delay(2.2).call(() => {\n                callBack();\n            }).start();\n        });\n    }\n\n    playAniSound(){\n        let dataSpine = this.dataQues.dataSpine;\n        let selectNum = this.selectItems.length;\n        kit.AudioPlayer.playEffect(this.arrAudioTitle[selectNum]);\n        this.playAnimation(this.skeletonLaba, dataSpine[2][1], true, 1, null);\n        this.scheduleOnce(() => {\n            this.playAnimation(this.skeletonLaba, dataSpine[2][0], true, 1, null);\n            this.setIsLock(false);\n            this.tipStart();\n        }, 1.5);\n    }\n\n    playAniWin(): void {\n        let timeDis = 0.5, scaleDis = 2;\n        let timeLong = this.nodeLong.scale * timeDis / scaleDis;\n        let timeRole = this.nodeRole.scale * timeDis / scaleDis;\n        cc.tween(this.node).call(() => {\n            cc.tween(this.nodeLong).to(timeLong, { scale: 1 }).start();\n        }).delay(timeLong).call(() => {\n            cc.tween(this.nodeRole).to(timeRole, { scale: 1 }).start();\n        }).delay(timeRole).call(() => {\n            kit.AudioPlayer.playEffect(this.arrAudioCom[3]);\n        }).start();\n    }\n\n    setIsLock(isLock: boolean): void {\n        this.isLock = isLock;\n        if (this.isLock) {\n            this.tipHide();\n        }\n    }\n\n    refreshDataForMsg(_data: any): void {\n        this.quesIndex = _data.quesIndex;\n        this.selectItems = _data.selectItems;\n    }\n\n    updateDataForMsg(_data: any): void {\n        this.selectItems.push(_data.itemId);\n        if (this.selectItems.length > this.arrQues.length - 1) {\n            this.isFinish = true;\n        }\n    }\n\n    /**\n     * 发送消息\n     * @param cmd \n     * @param object \n     */\n    sendMessage(cmd: string, object: {}): void {\n        var handleData = {\n            cmd: cmd,\n            page: this.pageNum,\n            info: {\n                itemId: 0,\n                result: false,\n                quesIndex: this.quesIndex,\n                selectItems: this.selectItems,\n            }\n        };\n        for (const key in object) {\n            if (Object.prototype.hasOwnProperty.call(object, key)) {\n                handleData.info[key] = object[key];\n            }\n        }\n\n        let tempData = {\n            isTeacher: this.isTeacher,\n            actionData: handleData\n        };\n        if (this.reDebug) {\n            this.receiveMessage(tempData);\n            return;\n        }\n        this.content.postMessage(JSON.stringify(tempData));\n    }\n\n    /**\n     * 播放骨骼动画\n     * @param {*} skeleton \n     * @param {*} aniName \n     * @param {*} isLoop \n     * @param {*} callBack \n     */\n    playAnimation(skeleton, aniName, isLoop, timeScale, callBack) {\n        skeleton.timeScale = timeScale;\n        skeleton.setToSetupPose();\n        skeleton.clearTracks();\n        if (callBack) {\n            skeleton.setCompleteListener(() => {\n                skeleton.setCompleteListener(null);\n                callBack();\n            });\n        }\n        let entry = skeleton.setAnimation(0, aniName, isLoop);\n        return entry;\n    }\n\n    /**\n     * 播放动画数组\n     * @param {*} skeleton \n     * @param {*} index \n     * @param {*} arrSpine \n     * @param {*} callBack \n     */\n    playAniArray(skeleton, index, arrSpine, callBack) {\n        let length = arrSpine.length;\n        if (index < length - 1) {\n            this.playAnimation(skeleton, arrSpine[index], false, 1, () => {\n                index++;\n                this.playAniArray(skeleton, index, arrSpine, callBack);\n            });\n        }\n        else {\n            this.playAnimation(skeleton, arrSpine[index], true, 1, null);\n            if (callBack) {\n                callBack();\n            }\n        }\n    };\n\n    /*********************************** 需要实现的抽象函数 **********************************/\n    setParams(data: { evn: center.EVN; isTeacher?: boolean; userInfo?: center.UserInfo; font?: cc.Font; }): void {\n        cc.log(`set params: ${JSON.stringify(data)}`);\n        this.pageNum = 0;\n        this.isTeacher = data.isTeacher || false;\n    }\n\n    setContent(content: center.IContent): void {\n        this.content = content;\n    }\n\n    receiveMessage(data: any): void {\n        let handleData = data.actionData;\n        cc.log(`${JSON.stringify(handleData)},`);\n        if (handleData && handleData.cmd && handleData.info) {\n            let info = handleData.info;\n            switch (handleData.cmd) {\n                case this.event_game_next:\n                    this.msgResultElse(info);\n                    break;\n                case this.event_game_sound:\n                    this.msgResultSound(info);\n                    break;\n                case this.event_game_touch:\n                    this.msgResultTouch(info);\n                    break;\n                default:\n                    break;\n            }\n        }\n    }\n}\n","\n\nconst { ccclass, property } = cc._decorator;\n\nenum HandSpineAnimationName {\n    danji = \"dainji\",\n    dianji = 'dainjitaiqi',\n    taishou = 'taiqi',\n}\n\nenum ApertureAnimationName {\n    dianji = 'dianji',\n    taishou = 'taishou'\n}\n\n@ccclass\nexport default class HandCtr extends cc.Component {\n\n    @property({ type: sp.Skeleton, displayName: '光圈' }) skAperture: sp.Skeleton = null;\n    @property({ type: sp.Skeleton, displayName: '手指' }) skHand: sp.Skeleton = null;\n    @property({ type: cc.Node, displayName: '箭头' }) arrow: cc.Node = null;\n    private arrowWidth: number = 0//箭头长度\n    start() {\n        // this.Press();\n\n        // this.scheduleOnce(() => { this.Lift(); }, 5);\n        //this.Click();\n        // this.ClickCycle();\n\n        // this.TouchCycle(cc.v2(-100, -200), cc.v2(100, 200));gong\n    }\n\n    onEnable() {\n        this.skAperture.node.active = false;\n    }\n\n    onDisable() {\n        this.arrow.stopAllActions()\n        this.arrow.width = 0;\n        this.node.stopAllActions();\n        this.unscheduleAllCallbacks();\n    }\n\n    /* 按下 */\n    private Press(callback: Function) {\n        this.skAperture.node.active = false;\n        this.playSpine(this.skHand, HandSpineAnimationName.danji, false, () => {\n            this.skAperture.node.active = true;\n            this.playSpine(this.skAperture, ApertureAnimationName.dianji, false, () => {\n                callback && callback();\n            });\n        });\n    }\n\n    /* 抬起 */\n    private Lift(callback: Function) {\n        this.playSpine(this.skHand, HandSpineAnimationName.taishou, false, () => {\n\n            callback && callback();\n        });\n    }\n\n    /* 点击 */\n    Click(callback: Function = null) {\n        this.skAperture.node.active = true;\n        this.playSpine(this.skAperture, ApertureAnimationName.dianji, false);\n        this.playSpine(this.skHand, HandSpineAnimationName.danji, false, () => {\n            this.playSpine(this.skHand, HandSpineAnimationName.taishou, false, () => {\n                callback && callback();\n            });\n        });\n    }\n\n    /* 点击循环 */\n    ClickCycle() {\n        this.node.active = true\n        this.schedule(() => {\n            this.Click();\n        }, 2, cc.macro.REPEAT_FOREVER, 0.01);\n    }\n\n    /* 可以调节点击速度的 点击循环 */\n    ClickCycleByScale(mScale,speed) {\n        this.node.active=true\n        this.schedule(() => {\n            this.Click();\n        }, speed,cc.macro.REPEAT_FOREVER,0.01);\n        this.skHand.timeScale = mScale;\n        this.skAperture.timeScale = mScale;\n    }\n\n    TouchAnimation(starPos: cc.Vec2, endPos: cc.Vec2, time: number = 0.5) {\n        this.node.active = true\n        this.node.stopAllActions();\n        this.node.setPosition(starPos);\n        this.arrow.width = 0;\n        this.Press(() => {\n            cc.tween(this.node)\n                .to(time, { position: cc.v3(endPos.x, endPos.y, 0) })\n                .call(() => {\n                    this.Lift(null)\n                })\n                .start();\n            cc.tween(this.arrow)\n                .to(time, { width: this.arrowWidth })\n                .call(() => {\n                })\n                .start();\n        });\n    }\n\n    /**\n     *  单次滑动，可以传入多个 位移点\n     * @param starPos  起始点\n     * @param nxetPosList 下次目标点 和移动时间\n     */\n    MoveWithPosList(starPos: cc.Vec2, nxetPosList: { pos: cc.Vec2, time: number }[]) {\n        this.node.active = true\n        this.node.stopAllActions();\n        this.node.setPosition(starPos);\n        this.arrow.width = 0;\n\n        let allMove=[]\n        for (let v of nxetPosList) {\n            let move = ()=>{\n                return new Promise((resolve, reject) => {\n                    cc.tween(this.node)\n                    .to(v.time, { position: cc.v3(v.pos.x, v.pos.y, 0) })\n                    .call(()=>{\n                        resolve(null)\n                    }).start()\n                })\n            }\n            allMove.push(move)\n        }\n\n        function queue(arr) {\n            let sequence = Promise.resolve()\n            arr.forEach(item => {\n                sequence = sequence.then(item)\n            })\n            return sequence\n        }\n       return new Promise<void>((resolve)=>{\n        this.Press(()=>{\n            queue(allMove).then(res => {\n                this.Lift(null)\n                resolve()\n            })\n        });\n       })\n      \n    }\n\n\n\n    /**\n     * 拖拽循环\n     * @param starPos 开始位置\n     * @param endPos 结束位置\n     * @param waitTime 上一次与下一次的运行间隔\n     * @param runTime 运行花费的时间\n     */\n    TouchCycle(starPos: cc.Vec2, endPos: cc.Vec2, waitTime: number = 3, runTime: number = 0.5,) {\n        this.node.setPosition(starPos);\n        this.schedule(() => {\n            this.TouchAnimation(starPos, endPos, runTime);\n        }, waitTime, cc.macro.REPEAT_FOREVER, 0.01);\n        let arrowWidth = Math.abs(endPos.x - starPos.x)\n        let arrowHeight = Math.abs(endPos.y - starPos.y)\n        let dir = endPos.sub(starPos);\n        let angle = dir.signAngle(cc.v2(1, 0));\n        let degree = (angle / Math.PI) * 180;\n        this.arrow.active = true;\n        this.arrow.angle = -degree;\n        this.arrowWidth = Math.sqrt(arrowWidth * arrowWidth + arrowHeight * arrowHeight) / this.node.scale;\n        if (this.arrow.getChildByName(\"arrow\").width < this.arrowWidth) {\n            this.arrow.getChildByName(\"arrow\").width = this.arrowWidth;\n        }\n    }\n\n    stopCycleAllAction() {\n        this.unscheduleAllCallbacks();\n        cc.Tween.stopAllByTarget(this.node);\n        cc.Tween.stopAllByTarget(this.arrow);\n    }\n\n    wipeCycle(starPos: cc.Vec2, endPos: cc.Vec2, speed: number = 200) {\n        this.node.active = true\n        this.node.setPosition(starPos);\n        this.arrow.active = false;\n        let len = endPos.sub(starPos).mag();\n        this.playSpine(this.skHand, HandSpineAnimationName.danji, false, () => {\n            this.skAperture.node.active = true;\n            this.playSpine(this.skAperture, ApertureAnimationName.dianji, true);\n            cc.tween(this.node).repeatForever(\n                cc.tween()\n                    .to(len / speed, { position: cc.v3(endPos) })\n                    .to(len / speed, { position: cc.v3(starPos) })\n\n            ).start()\n        });\n    }\n\n    private playSpine(spNode: sp.Skeleton, spName: string, loop: boolean = false, callback = null) {\n        spNode.clearTracks();\n        spNode.setToSetupPose();\n        let track = spNode.setAnimation(0, spName, loop);\n        if (track && !loop) {\n            spNode.setCompleteListener((trackEntry, loopCount) => {\n                let name = trackEntry.animation.name ? trackEntry.animation.name : \"\";\n                if (name == spName && callback) {\n                    callback();\n                }\n            });\n        }\n    }\n\n}\n"],"file":"index.js"}